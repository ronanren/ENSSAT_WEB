<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>TP2</title>
</head>

<style type="text/css">

</style>

<body>
	<header>
		<h1>Bienvenue au TP2 de JS</h1>
	</header>
	<canvas id="canvas" height="500" width="750"></canvas>
</body>
<script>
	var canvas = document.getElementById("canvas");
	var ctx = canvas.getContext('2d');
	ctx.fillStyle = 'red';
	ctx.fillRect(0, 50, 100, 100);
	ctx.fillRect(0, 160, 100, 100);
	ctx.fillRect(0, 270, 100, 100);
	x = 0;
	var rect2 = 0, rect3 = 0;

	function pausecomp(millis) {
		var date = new Date();
		var curDate = null;
		do {
			curDate = new Date();
		} while (curDate - date < millis);
	}

	function draw(timestamp) {
		requestAnimationFrame(draw);

		ctx.clearRect(0, 0, canvas.width, canvas.height);
		ctx.beginPath();
		ctx.rect(x, 50, 100, 100);
		if (rect2 == 1)
			ctx.rect(x - 100, 160, 100, 100);
		else
			ctx.rect(0, 160, 100, 100);

		if (rect3 == 1)
			ctx.rect(x - 400, 270, 100, 100);
		else
			ctx.rect(0, 270, 100, 100);
		ctx.fillStyle = "red";
		ctx.fill();
		// pausecomp(500);
		x += (timestamp - last) / 10;;
		last = timestamp;
	}
	document.addEventListener('DOMContentLoaded', (event) => {
		setTimeout(() => {
			rect2 = 1;
		}, 1000);
	});

	document.addEventListener('DOMContentLoaded', (event) => {
		setTimeout(() => {
			rect3 = 1;
		}, 4000);
	});

	last = performance.now();
	requestAnimationFrame(draw);
</script>

</html>